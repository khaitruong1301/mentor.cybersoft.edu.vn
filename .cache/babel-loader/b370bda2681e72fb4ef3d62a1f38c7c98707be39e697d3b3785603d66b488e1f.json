{"ast":null,"code":"//rxslice\nimport { createSlice, current } from '@reduxjs/toolkit';\nimport { AdminService } from '../../services/AdminService';\nimport { NguoiDungService } from '../../services/NguoiDungService';\nimport { USER_LOGIN } from '../../utils/constant';\nimport { history } from '../../utils/history';\nimport { checkQuyenUser } from '../../utils/SelectOption';\nimport { callApiChiNhanh, callApiLopHoc } from './lopHocReducer';\nimport { callApiKhachHang, callApiNguoiDung } from './userReducer';\nconst initialState = {\n  roleCom: null,\n  dsQuyen: [],\n  dsConfig: []\n};\nconst adminReducer = createSlice({\n  name: \"adminReducer\",\n  initialState,\n  reducers: {\n    getDanhSachQuyen: (state, _ref) => {\n      let {\n        type,\n        payload\n      } = _ref;\n      state.dsQuyen = payload;\n    },\n    getDanhSachConfig: (state, _ref2) => {\n      let {\n        type,\n        payload\n      } = _ref2;\n      state.dsConfig = payload;\n    },\n    setRoleCom: (state, _ref3) => {\n      let {\n        type,\n        payload\n      } = _ref3;\n      let nguoiDung = {\n        \"id\": \"b9376497-1678-42e0-b8f8-d5ccaa03274f\",\n        \"email\": \"admin@gmail.com\",\n        \"hoTen\": \"Admin\",\n        \"biDanh\": \"admin\",\n        \"soDT\": \"0941237751\",\n        \"facebookId\": \"\",\n        \"avatar\": \"/static/user-icon.png\",\n        \"urls\": \"$2b$10$/nRixjwK7lXUJ9M1jrjh4Oh0dfyyE4ecCkZWH0Yuh69NWoo0gkLhK\",\n        \"token\": \"eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL2V4cGlyZWQiOiIxMC8yMi8yMDQ1IDEwOjM3OjU1IFBNIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6ImI5Mzc2NDk3LTE2NzgtNDJlMC1iOGY4LWQ1Y2NhYTAzMjc0ZiIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL2VtYWlsYWRkcmVzcyI6ImFkbWluQGdtYWlsLmNvbSIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6WyJDX0tIIiwiQU5ZIiwiQ19MTCIsIkNfTE9QIiwiQ19ORCIsIkNIRUNLX01FTlRPUl9MT1AiLCJEX0RBTkgiLCJEX0tIIiwiRF9MTCIsIkRfTkQiLCJGX0dDIiwiRl9MT1AiLCJHRF9MSCIsIktfVFQiLCJOX1FVWUVOIiwiUUxfQkwiLCJRTF9CTSIsIlFMX0NMIiwiUUxfR0MiLCJRTF9ITVQiLCJRTF9LSCIsIlFMX0xUIiwiUUxfVFQiLCJSX0JIIiwiUl9LSCIsIlJfTEwiLCJSX0xPUCIsIlJfTkQiLCJSX1ZMIiwiVV9LSCIsIlVfTEwiLCJVX0xPUCIsIlVfTkQiLCJYX0tIX0wiLCJRTF9MQ04iLCJRTF9US0QiLCJRTF9DSFRMIiwiUUxfUk0iLCJEX0JUIl0sIm5iZiI6MTY2NjQ1MzA3NSwiZXhwIjoxNjY2NDU2Njc1fQ.fIwoFacMNwqu0nkUD7oXCUfusiBD9voE0PnQDtR1d3A\",\n        \"thongTinMoRong\": \"\",\n        \"danhSachLopHoc\": \"[\\\"258\\\",\\\"258\\\",\\\"254\\\",\\\"282\\\"]\",\n        \"thongTinLopHoc\": null,\n        \"maNhomQuyen\": \"SPADMIN\",\n        \"ngayTao\": \"2/21/2020 1:22:51 AM\",\n        \"color\": \"black\",\n        \"nuocNgoai\": false\n      };\n      NguoiDungService.checkPassService(nguoiDung).then(res => {\n        if (res.data.content == \"0\") {\n          localStorage.removeItem(USER_LOGIN);\n          history.push(\"/login\");\n          return;\n        }\n      }).catch(err => {\n        history.push(\"/login\");\n        return;\n      });\n      const {\n        dsQuyen\n      } = current(state);\n      if (dsQuyen.length > 0) {\n        state.roleCom = payload;\n\n        //check quyen hay ko\n        if (!checkQuyenUser(dsQuyen, payload)) {\n          history.push(\"/login\");\n        }\n      } else {\n        let {\n          pathname,\n          search\n        } = window.location;\n        pathname != \"/\" && localStorage.setItem(\"url_redirect\", pathname + search);\n        history.push(\"/h\");\n      }\n    }\n  }\n});\n\n//quản lý actions\nexport const {\n  getDanhSachQuyen,\n  getNhomQuyen,\n  setRoleCom,\n  getDanhSachConfig\n} = adminReducer.actions;\nexport default adminReducer.reducer;\n\n//setup redux thunk\n\n//closure function\nexport const callApiQuyen = userId => async dispatch => {\n  const apiQuyen = await AdminService.layQuyenUserService(userId);\n  dispatch(getDanhSachQuyen(apiQuyen.data.content));\n};\nexport const callApiConfig = () => async dispatch => {\n  const apiConfig = await AdminService.layDanhSachConfigService();\n  dispatch(getDanhSachConfig(apiConfig.data.content));\n};","map":{"version":3,"names":["createSlice","current","AdminService","NguoiDungService","USER_LOGIN","history","checkQuyenUser","callApiChiNhanh","callApiLopHoc","callApiKhachHang","callApiNguoiDung","initialState","roleCom","dsQuyen","dsConfig","adminReducer","name","reducers","getDanhSachQuyen","state","type","payload","getDanhSachConfig","setRoleCom","nguoiDung","checkPassService","then","res","data","content","localStorage","removeItem","push","catch","err","length","pathname","search","window","location","setItem","getNhomQuyen","actions","reducer","callApiQuyen","userId","dispatch","apiQuyen","layQuyenUserService","callApiConfig","apiConfig","layDanhSachConfigService"],"sources":["D:/BIG-PROJECT/WIKI/FE/crmmentor/src/redux/reducers/adminReducer.js"],"sourcesContent":["//rxslice\r\nimport { createSlice, current } from '@reduxjs/toolkit';\r\nimport { AdminService } from '../../services/AdminService';\r\nimport { NguoiDungService } from '../../services/NguoiDungService';\r\nimport { USER_LOGIN } from '../../utils/constant';\r\nimport { history } from '../../utils/history';\r\nimport { checkQuyenUser } from '../../utils/SelectOption';\r\nimport { callApiChiNhanh, callApiLopHoc } from './lopHocReducer';\r\nimport { callApiKhachHang, callApiNguoiDung } from './userReducer';\r\n\r\nconst initialState = {\r\n  roleCom: null,\r\n  dsQuyen: [],\r\n  dsConfig:[]\r\n};\r\n\r\nconst adminReducer = createSlice({\r\n  name: \"adminReducer\",\r\n  initialState,\r\n  reducers: {\r\n    getDanhSachQuyen: (state, { type, payload }) => {\r\n      state.dsQuyen = payload;\r\n    },\r\n    getDanhSachConfig: (state, { type, payload }) => {\r\n      state.dsConfig = payload;\r\n    },\r\n    setRoleCom: (state, { type, payload }) => {\r\n\r\n\r\n      let nguoiDung = { \"id\": \"b9376497-1678-42e0-b8f8-d5ccaa03274f\", \"email\": \"admin@gmail.com\", \"hoTen\": \"Admin\", \"biDanh\": \"admin\", \"soDT\": \"0941237751\", \"facebookId\": \"\", \"avatar\": \"/static/user-icon.png\", \"urls\": \"$2b$10$/nRixjwK7lXUJ9M1jrjh4Oh0dfyyE4ecCkZWH0Yuh69NWoo0gkLhK\", \"token\": \"eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL2V4cGlyZWQiOiIxMC8yMi8yMDQ1IDEwOjM3OjU1IFBNIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6ImI5Mzc2NDk3LTE2NzgtNDJlMC1iOGY4LWQ1Y2NhYTAzMjc0ZiIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL2VtYWlsYWRkcmVzcyI6ImFkbWluQGdtYWlsLmNvbSIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6WyJDX0tIIiwiQU5ZIiwiQ19MTCIsIkNfTE9QIiwiQ19ORCIsIkNIRUNLX01FTlRPUl9MT1AiLCJEX0RBTkgiLCJEX0tIIiwiRF9MTCIsIkRfTkQiLCJGX0dDIiwiRl9MT1AiLCJHRF9MSCIsIktfVFQiLCJOX1FVWUVOIiwiUUxfQkwiLCJRTF9CTSIsIlFMX0NMIiwiUUxfR0MiLCJRTF9ITVQiLCJRTF9LSCIsIlFMX0xUIiwiUUxfVFQiLCJSX0JIIiwiUl9LSCIsIlJfTEwiLCJSX0xPUCIsIlJfTkQiLCJSX1ZMIiwiVV9LSCIsIlVfTEwiLCJVX0xPUCIsIlVfTkQiLCJYX0tIX0wiLCJRTF9MQ04iLCJRTF9US0QiLCJRTF9DSFRMIiwiUUxfUk0iLCJEX0JUIl0sIm5iZiI6MTY2NjQ1MzA3NSwiZXhwIjoxNjY2NDU2Njc1fQ.fIwoFacMNwqu0nkUD7oXCUfusiBD9voE0PnQDtR1d3A\", \"thongTinMoRong\": \"\", \"danhSachLopHoc\": \"[\\\"258\\\",\\\"258\\\",\\\"254\\\",\\\"282\\\"]\", \"thongTinLopHoc\": null, \"maNhomQuyen\": \"SPADMIN\", \"ngayTao\": \"2/21/2020 1:22:51 AM\", \"color\": \"black\", \"nuocNgoai\": false };\r\n\r\n      NguoiDungService.checkPassService(nguoiDung).then(res => {\r\n\r\n        if (res.data.content == \"0\") {\r\n          localStorage.removeItem(USER_LOGIN);\r\n          history.push(\"/login\");\r\n          return;\r\n        }\r\n\r\n\r\n      }).catch(err => {\r\n        history.push(\"/login\");\r\n        return\r\n      })\r\n\r\n      const { dsQuyen } = current(state);\r\n\r\n      if (dsQuyen.length > 0) {\r\n        state.roleCom = payload;\r\n\r\n        //check quyen hay ko\r\n        if (!checkQuyenUser(dsQuyen, payload)) {\r\n          history.push(\"/login\")\r\n\r\n        }\r\n      } else {\r\n\r\n        let { pathname, search } = window.location;\r\n        pathname != \"/\" && localStorage.setItem(\"url_redirect\", pathname + search);\r\n        history.push(\"/h\")\r\n      }\r\n\r\n\r\n    },\r\n  }\r\n});\r\n\r\n//quản lý actions\r\nexport const {\r\n  getDanhSachQuyen,\r\n  getNhomQuyen,\r\n  setRoleCom,\r\n  getDanhSachConfig\r\n} = adminReducer.actions\r\n\r\nexport default adminReducer.reducer\r\n\r\n\r\n//setup redux thunk\r\n\r\n//closure function\r\nexport const callApiQuyen = (userId) => async (dispatch) => {\r\n  const apiQuyen = await AdminService.layQuyenUserService(userId);\r\n\r\n  dispatch(getDanhSachQuyen(apiQuyen.data.content));\r\n}\r\n\r\nexport const callApiConfig = () => async (dispatch) => {\r\n  const apiConfig = await AdminService.layDanhSachConfigService();\r\n\r\n  dispatch(getDanhSachConfig(apiConfig.data.content));\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}