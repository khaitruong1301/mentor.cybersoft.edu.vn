{"ast":null,"code":"import { tinhKhoangCachHaiNgay } from \"./DateFormat\";\nexport const ListChuaCham = dsBaiTapDaCham => {\n  let danhSachBaiTapChuaCham = [];\n  const hanChamBai = 8;\n  if (dsBaiTapDaCham != null) dsBaiTapDaCham.map(itemDaCham => {\n    let ngayHeThong = new Date(itemDaCham.ngayHeThong);\n    const {\n      danhSachBuoiHocNew\n    } = itemDaCham.lopHoc;\n    const danhSachBuoiHoc = danhSachBuoiHocNew.length > 0 && danhSachBuoiHocNew != \"\" ? JSON.parse(danhSachBuoiHocNew) : [];\n    const danhSachHocVien = itemDaCham.lopHoc.danhSachHocVien ? JSON.parse(itemDaCham.lopHoc.danhSachHocVien) : [];\n    const danhSachMentor = itemDaCham.lopHoc.danhSachHocVien ? JSON.parse(itemDaCham.lopHoc.danhSachMentor) : [];\n    const danhSachBaiTap = [];\n    danhSachBuoiHoc.map(item => {\n      danhSachBaiTap.push(...item.BaiTap.danhSachBaiHoc, ...item.Capstone.danhSachBaiHoc);\n    });\n    let {\n      lstBaiTapNop\n    } = itemDaCham;\n    let lstBaiChuaCham = [];\n    danhSachBaiTap.map(item => {\n      let tongBaiNop = lstBaiTapNop.filter(n => n.maBaiHoc == item.Id);\n\n      //loc cac hoc vien da nghi hoc nhung co nop bai\n      tongBaiNop = tongBaiNop.filter(item => {\n        if (danhSachHocVien.findIndex(n => n == item.maNguoiDung) != -1) return item;\n      });\n      let ngayHetHan = new Date(item.NgayHetHan);\n      let soNgayCham = hanChamBai - tinhKhoangCachHaiNgay(ngayHeThong, ngayHetHan);\n      if (ngayHeThong > ngayHetHan && soNgayCham <= 0) {\n        //loc bai tap chua cham \n        let lstChuaCham = tongBaiNop.filter(n => n.diem == -1);\n        if (lstChuaCham.length > 0) {\n          //loc mentor cham bai chinh\n          let lstMentorChinh = [];\n          danhSachMentor.map(itemMentor => {\n            let demDaCham = tongBaiNop.filter(n => n.nguoiCham == itemMentor);\n            lstMentorChinh.push({\n              mentorId: itemMentor,\n              soLuongDaCham: demDaCham.length\n            });\n          });\n\n          //add class chua cham\n          lstBaiChuaCham.push({\n            ...item,\n            tongBaiNop: tongBaiNop.length,\n            chuaCham: lstChuaCham.length,\n            lstMentorChinh\n          });\n        }\n      }\n    });\n\n    //them list chua cham và noi dung lop\n    if (lstBaiChuaCham.length > 0) danhSachBaiTapChuaCham.push({\n      tenLopHoc: itemDaCham.lopHoc.tenLopHoc,\n      lstBaiChuaCham\n    });\n  });\n  return danhSachBaiTapChuaCham;\n};\n_c = ListChuaCham;\nexport const ListXepHangDanhGia = danhSachDanhGia => {\n  let listDanhGia = [];\n  danhSachDanhGia.map((item, index) => {\n    let {\n      mentorId,\n      noiDung\n    } = item;\n    let checkDanhGia = listDanhGia.find(n => n.mentorId == mentorId);\n    // noiDung = noiDung.replaceAll('\\n', \"\")\n    try {\n      let diemDanhGia = item && noiDung ? JSON.parse(noiDung) : [];\n      let congDiem = 0;\n      //check diem 4 va 5 thi moi cong\n      diemDanhGia.map(itemDiem => congDiem += itemDiem > 3 ? itemDiem : 0);\n      if (checkDanhGia) {\n        checkDanhGia.soLuong += 1;\n        checkDanhGia.tongDiem += congDiem;\n      } else {\n        listDanhGia.push({\n          mentorId,\n          soLuong: 1,\n          tongDiem: congDiem\n        });\n      }\n    } catch (error) {\n      // console.log(item)\n    }\n  });\n  listDanhGia.sort((a, b) => b.tongDiem - a.tongDiem);\n  listDanhGia[0] = {\n    ...listDanhGia[0],\n    top: 1\n  };\n  listDanhGia[1] = {\n    ...listDanhGia[1],\n    top: 2\n  };\n  listDanhGia[2] = {\n    ...listDanhGia[2],\n    top: 3\n  };\n  return listDanhGia;\n};\n_c2 = ListXepHangDanhGia;\nvar _c, _c2;\n$RefreshReg$(_c, \"ListChuaCham\");\n$RefreshReg$(_c2, \"ListXepHangDanhGia\");","map":{"version":3,"names":["tinhKhoangCachHaiNgay","ListChuaCham","dsBaiTapDaCham","danhSachBaiTapChuaCham","hanChamBai","map","itemDaCham","ngayHeThong","Date","danhSachBuoiHocNew","lopHoc","danhSachBuoiHoc","length","JSON","parse","danhSachHocVien","danhSachMentor","danhSachBaiTap","item","push","BaiTap","danhSachBaiHoc","Capstone","lstBaiTapNop","lstBaiChuaCham","tongBaiNop","filter","n","maBaiHoc","Id","findIndex","maNguoiDung","ngayHetHan","NgayHetHan","soNgayCham","lstChuaCham","diem","lstMentorChinh","itemMentor","demDaCham","nguoiCham","mentorId","soLuongDaCham","chuaCham","tenLopHoc","ListXepHangDanhGia","danhSachDanhGia","listDanhGia","index","noiDung","checkDanhGia","find","diemDanhGia","congDiem","itemDiem","soLuong","tongDiem","error","sort","a","b","top"],"sources":["D:/BIG-PROJECT/WIKI/FE/crmmentor/src/utils/ListChuaCham.js"],"sourcesContent":["import { tinhKhoangCachHaiNgay } from \"./DateFormat\";\r\n\r\n\r\nexport const ListChuaCham = (dsBaiTapDaCham) => {\r\n\r\n    let danhSachBaiTapChuaCham = [];\r\n\r\n    const hanChamBai = 8;\r\n    if (dsBaiTapDaCham != null)\r\n\r\n        dsBaiTapDaCham.map(itemDaCham => {\r\n            let ngayHeThong = new Date(itemDaCham.ngayHeThong);\r\n\r\n            const { danhSachBuoiHocNew } = itemDaCham.lopHoc;\r\n            const danhSachBuoiHoc = danhSachBuoiHocNew.length > 0 && danhSachBuoiHocNew != \"\" ? JSON.parse(danhSachBuoiHocNew) : [];\r\n\r\n            const danhSachHocVien = itemDaCham.lopHoc.danhSachHocVien ? JSON.parse(itemDaCham.lopHoc.danhSachHocVien) : [];\r\n            const danhSachMentor = itemDaCham.lopHoc.danhSachHocVien ? JSON.parse(itemDaCham.lopHoc.danhSachMentor) : [];\r\n\r\n            const danhSachBaiTap = [];\r\n            danhSachBuoiHoc.map(item => {\r\n\r\n                danhSachBaiTap.push(...item.BaiTap.danhSachBaiHoc, ...item.Capstone.danhSachBaiHoc);\r\n\r\n            })\r\n\r\n            let { lstBaiTapNop } = itemDaCham;\r\n            let lstBaiChuaCham = [];\r\n            danhSachBaiTap.map(item => {\r\n                let tongBaiNop = lstBaiTapNop.filter(n => n.maBaiHoc == item.Id);\r\n\r\n\r\n                //loc cac hoc vien da nghi hoc nhung co nop bai\r\n                tongBaiNop = tongBaiNop.filter(item => {\r\n\r\n                    if (danhSachHocVien.findIndex(n => n == item.maNguoiDung) != -1)\r\n                        return item;\r\n                })\r\n\r\n                let ngayHetHan = new Date(item.NgayHetHan);\r\n                let soNgayCham = hanChamBai - tinhKhoangCachHaiNgay(ngayHeThong, ngayHetHan);\r\n\r\n                if (ngayHeThong > ngayHetHan && soNgayCham <= 0) {\r\n\r\n                    //loc bai tap chua cham \r\n                    let lstChuaCham = tongBaiNop.filter(n => n.diem == -1);\r\n\r\n                    if (lstChuaCham.length > 0) {\r\n\r\n                        //loc mentor cham bai chinh\r\n                        let lstMentorChinh = [];\r\n                        danhSachMentor.map(itemMentor => {\r\n                            let demDaCham = tongBaiNop.filter(n => n.nguoiCham == itemMentor);\r\n                            lstMentorChinh.push({ mentorId: itemMentor, soLuongDaCham: demDaCham.length });\r\n                        })\r\n\r\n\r\n                        //add class chua cham\r\n                        lstBaiChuaCham.push({\r\n                            ...item,\r\n                            tongBaiNop: tongBaiNop.length,\r\n                            chuaCham: lstChuaCham.length,\r\n                            lstMentorChinh\r\n                        });\r\n                    }\r\n                }\r\n            })\r\n\r\n            //them list chua cham và noi dung lop\r\n            if (lstBaiChuaCham.length > 0)\r\n                danhSachBaiTapChuaCham.push({\r\n                    tenLopHoc: itemDaCham.lopHoc.tenLopHoc,\r\n                    lstBaiChuaCham\r\n                })\r\n        });\r\n    return danhSachBaiTapChuaCham;\r\n\r\n}\r\n\r\n\r\nexport const ListXepHangDanhGia = (danhSachDanhGia) => {\r\n\r\n    let listDanhGia = [];\r\n\r\n    danhSachDanhGia.map((item,index) => {\r\n        let { mentorId, noiDung } = item;\r\n        let checkDanhGia = listDanhGia.find(n => n.mentorId == mentorId);\r\n            // noiDung = noiDung.replaceAll('\\n', \"\")\r\n            try {\r\n                 let diemDanhGia = item && noiDung ? JSON.parse(noiDung) : [];\r\n let congDiem = 0;\r\n        //check diem 4 va 5 thi moi cong\r\n        diemDanhGia.map(itemDiem => congDiem += itemDiem > 3 ? itemDiem : 0);\r\n\r\n        if (checkDanhGia) {\r\n            checkDanhGia.soLuong += 1;\r\n            checkDanhGia.tongDiem += congDiem;\r\n        }\r\n        else {\r\n\r\n            listDanhGia.push({\r\n                mentorId,\r\n                soLuong: 1,\r\n                tongDiem: congDiem\r\n            })\r\n        }\r\n\r\n            } catch (error) {\r\n                // console.log(item)\r\n            }\r\n           \r\n       \r\n        \r\n\r\n       \r\n    })\r\n\r\n    listDanhGia.sort((a, b) => b.tongDiem - a.tongDiem);\r\n\r\n    listDanhGia[0] = {...listDanhGia[0],top:1};\r\n    listDanhGia[1] = {...listDanhGia[1],top:2};\r\n    listDanhGia[2] = {...listDanhGia[2],top:3};\r\n\r\n    return listDanhGia;\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}